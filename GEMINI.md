# 勤怠管理アプリの概要

## 機能要件一覧						
	"この画面に定義されている要件に準拠して機能を実装してください。
						
	No.	"ユーザーストーリー
ID"	ユーザーストーリー	要件ID	機能一覧	機能詳細（完了状態）
	1	US001	新規一般ユーザーは，システムの一般機能に会員登録することができる。	FN001	登録認証機能（一般ユーザー）	使用技術 : fortify
				FN002	バリデーション	"使用技術：formrequest
バリデーションルールはFN003を参照すること"
				FN003	エラーメッセージ表示	"1. 未入力の場合
    1. お名前を入力してください
    2. メールアドレスを入力してください
    3. パスワードを入力してください
2. パスワードの入力規則違反の場合
    1. パスワードは8文字以上で入力してください
3. 確認用パスワードの入力規則違反の場合
    1. パスワードと一致しません

以上の文言は必ず守ってください。評価項目になります。"
				FN004	ユーザー認証動線	会員登録画面からログイン画面に遷移できる
				FN005	初回ログイン時ユーザー設定	会員登録直後、打刻画面に遷移すること（メール認証を実装しなかった場合）
	2	US002	一般ユーザーは，システムの一般機能にログインすることができる。	FN006	ログイン認証機能（一般ユーザー）	使用技術 : fortify
				FN007	入力フォーム	"必要な情報
1. メールアドレス
2. パスワード"
				FN008	バリデーション	"使用技術：formrequest
バリデーションルールは本シートを参照し、必要に応じて適時埋めること"
				FN009	エラーメッセージ表示	"1. 未入力の場合
    1. メールアドレスを入力してください
    2. パスワードを入力してください
2. 入力情報が誤っている場合
    1. ログイン情報が登録されていません"
				FN010	ユーザー認証動線	ログイン画面から会員登録画面に遷移できる
				FN011	メールを用いた認証機能	"1.  新規会員登録にメール認証を行う
2. 新規会員登録後にメール認証をしないでログインを試みた場合はメール認証誘導画面へ遷移
2. メール認証を実装した際の画面遷移
　a. 初回会員登録
　b. メール認証誘導画面
　c. メール認証画面
4. メール認証を行うのは会員登録時、初回ログイン時
3. 使用技術：mailhogかmailtrap"
				FN012	認証メール再送機能	メール認証誘導画面で「認証メール再送」ボタンをクリックすると認証メールを再送信される
	3	US003	一般ユーザーは，システムの一般機能からログアウトすることができる。	FN013	ログアウト機能	"使用技術：fortify
ヘッダーのボタンから正常にログアウトを行える"
	4	US004	管理者ユーザーは，システムの管理機能にログインすることができる。	FN014	ログイン認証機能（管理者）	使用技術 : fortify
				FN015	バリデーション機能	"使用技術：formrequest
バリデーションルールはFN016を参照すること"
				FN016	エラーメッセージ表示機能	"1. 未入力の場合
    1. メールアドレスを入力してください
    2. パスワードを入力してください
2. 入力情報が誤っている場合
    1. ログイン情報が登録されていません"
	5	US005	管理者ユーザーは，管理機能からログアウトすることができる。	FN017	ログアウト機能	"使用技術：fortify
ヘッダーのボタンから正常にログアウトを行える"
	6	US006	一般ユーザーは，勤怠の打刻をすることができる	FN018	日時情報取得機能	現在の日時情報がUIと同じ形式で出力されていること
				FN019	ステータス確認機能	"以下のステータスが表示されていること
勤務外，出勤中，休憩中，退勤済"
				FN020	出勤機能	"1. 勤務外のステータスを持つときに「出勤」というボタンが表示されていること
2. 「出勤」は1日に1回だけ押下できること
3. 「出勤」を押下した時に，画面が「出勤中」ステータスのものに変更になること
4. 出勤時刻が管理画面から正確に確認できること"
				FN021	休憩機能	"1. 「出勤中」のステータスを持つときに「休憩」というボタンが表示されていること
2. 「休憩入」ボタンは1日に何回でも押下できる
3. 「休憩入」ボタンを押下した時に，画面が「休憩中」ステータスのものに変更になること
4. 「休憩中」のステータスを持つときに「休憩戻」というボタンが表示されていること
5. 「休憩戻」ボタンは1日に何回でも押下できる
　a. 勤怠詳細画面で休憩回数分のレコードを作成する
6. 「休憩戻」ボタンを押下した時に，画面が「出勤中」ステータスのものに変更になること
7. 休憩に関する時刻が管理画面で正確に確認できること"
				FN022	退勤機能	"1. 「出勤中」のステータスを持つときに「退勤」というボタンが表示されていること
2. 「退勤」ボタンは1日に1回だけ押下できる
3. 「退勤」ボタンを押下した時に，「お疲れ様でした。」とメッセージが表示される
4. 「退勤」ボタンを押下した時に，「退勤済」というステータスに変更される
5. 退勤時刻が管理画面から確認できること"
	7	US007	一般ユーザーは，勤怠一覧を確認することができる	FN023	勤怠一覧情報取得機能	"1. 自分が行った勤怠情報が全て表示されていること
2. カラムがUIと同じ構成になっていること。（勤怠情報がないフィールドは空白になっていること）"
				FN024	月情報取得機能	"1. 遷移した際に現在の月が表示される
2. 「前月」を押下した時に，表示月の前月の情報が表示される。
3. 「翌月」を押下した時に，表示月の翌月の情報が表示される。"
				FN025	詳細遷移機能	「詳細」を押下すると，その日の勤怠詳細画面に遷移すること
	8	US008	一般ユーザーは，勤怠詳細を確認 / 修正申請することができる	FN026	詳細情報取得機能	"1. 「名前」が，自分の氏名になっていること
2. 「日付」が，動線上で自分が選択した日時と一致していること
3. 「出勤・退勤」「休憩」にて記されている時間が，自分の打刻と一致していること
4. 「休憩」について、休憩回数分のレコードと追加で１つ分の入力フィールドが表示されること"
				FN027	項目編集機能	"「出勤・退勤」「休憩」「備考」の3つの項目において，修正したい内容を記載できるフィールドになっていること
「承認待ち」の申請詳細は，修正を行うことができず，
「承認待ちのため修正はできません。」とメッセージが表示されていること"
				FN028	バリデーション機能	"使用技術：formrequest
バリデーションルールは別シート「基本設計書」を参照"
				FN029	エラーメッセージ表示機能	"1. 出勤時間が退勤時間より後になっている場合，および退勤時間が出勤時間より前になっている場合に以下のメッセージを表示
　・出勤時間もしくは退勤時間が不適切な値です
2. 休憩開始時間が出勤時間より前になっている場合及び退勤時間より後になっている場合、以下のメッセージを表示
　・休憩時間が不適切な値です
3.休憩終了時間が退勤時間より後になっている場合、以下のメッセージを表示
　・休憩時間もしくは退勤時間が不適切な値です
4. 備考欄が未入力になっている際に，以下のメッセージを表示
　・備考を記入してください"
				FN030	修正申請機能	"「修正」ボタンを押下すると，修正申請が実行されること
修正申請が実行されると，その勤怠情報は以下のように扱われること
　1. 管理者ユーザーの「修正申請承認画面」に表示される
　2. 一般ユーザーの「申請一覧画面」の""承認待ち""内に表示される"
	9	US009	一般ユーザーは，自分が行った申請を確認することができる	FN031	承認待ち情報取得機能	"1. ""承認待ち""には，自分が行った申請のうち，管理者が承認していないものが全て表示されていること
2. 各項目にはUIと同一の項目が表示されていること
3. 管理者によって承認された場合は，承認済み移動する"
				FN032	承認済み情報取得機能	"1. ""承認済み""には，管理者が承認した修正申請が全て表示されていること
2. 各項目にはUIと同一の項目が表示されていること"
				FN033	申請詳細表示機能	"1. 各項目の「詳細」を押下すると，勤怠詳細画面に遷移すること
2. 「承認待ち」の申請詳細は，修正を行うことができず，「承認待ちのため修正はできません。」とメッセージが表示されていること"
	10	US010	管理者ユーザーは日次勤怠一覧を確認することができる	FN034	勤怠情報取得機能	"1. その日になされた全ユーザーの勤怠情報が確認できること
2. 勤怠情報が正確な値になっていること
3. リストのカラムがUIと一致していること（まだされていない勤怠のフィールドは空白になっていること）"
				FN035	日時変更機能	"1. 遷移した際に現在の日付が表示されること
2. 「前日」を押下した時に，前の日の勤怠情報が表示されること
2. 「翌日」を押下した時に，次の日の勤怠情報が表示されること"
				FN036	勤怠詳細表示機能	各勤怠の「詳細」を押下した際に，勤怠詳細画面に遷移すること
	11	US011	管理者ユーザーは各勤怠の詳細を確認・修正することができる	FN037	詳細情報取得機能	"1. 詳細画面の内容が，動線上で自分が選択した情報と一致していること
2. 詳細画面の内容が，正しく実際の勤怠内容が反映されていること"
				FN038	項目編集機能	"「出勤・退勤」「休憩」「備考」の4つの項目において，修正したい内容を記載できるフィールドになっていること
「承認待ち」の申請詳細は，修正を行うことができず，
「承認待ちのため修正はできません。」とメッセージが表示されていること"
				FN039	バリデーション機能	"1. 出勤時間が退勤時間より後になっている場合，および退勤時間が出勤時間より前になっている場合に以下のメッセージを表示
　・出勤時間もしくは退勤時間が不適切な値です
2. 休憩開始時間が出勤時間より前になっている場合及び退勤時間より後になっている場合、以下のメッセージを表示
　・休憩時間が不適切な値です
3.休憩終了時間が退勤時間より後になっている場合、以下のメッセージを表示
　・休憩時間もしくは退勤時間が不適切な値です
4. 備考欄が未入力になっている際に，以下のメッセージを表示
　・備考を記入してください"
				FN040	修正機能	"1. 「修正」ボタンを押下すると，管理者として直接修正が実行されること
2. 修正された内容は一般ユーザーの勤怠情報としても反映されていること"
	12	US012	管理者ユーザーはスタッフ一覧を確認することができる	FN041	ユーザー情報取得機能	全一般ユーザーの「氏名」「メールアドレス」が正しく表示されていること
				FN042	月次勤怠遷移機能	「詳細」を押下することによって，各ユーザーの月次勤怠一覧に遷移すること
		US013	管理者ユーザーはスタッフ毎の月次勤怠一覧を確認することができる	FN043	勤怠一覧情報取得機能	"1. 動線上選択したユーザーの勤怠情報が全て表示されていること
2. カラムがUIと同じ構成になっていること。（勤怠情報がないフィールドは空白になっていること）"
				FN044	月表示変更機能	"1. 遷移した際に現在の月が表示されること
2. 「前月」を押下した時に，表示月の前月の情報が表示されること
3. 「翌月」を押下した時に，表示月の翌月の情報が表示されること"
				FN045	CSV出力機能	「CSV出力」を押下すると，当該ユーザーが選択した月で行った勤怠一覧情報がCSVでダウンロードできること
				FN046	詳細遷移機能	「詳細」を押下すると，その日の勤怠詳細画面に遷移すること
		US014	管理者ユーザーは修正申請一覧を確認することができる	FN047	承認待ち情報取得機能	"1. ""承認待ち""には全ての一般ユーザーが行った未承認の修正申請が全て表示されていること
2. カラムの項目がUIと一致していること"
				FN048	承認済み情報取得機能	"1. ""承認済み""には，全ての一般ユーザーが行った，これまでの承認済みの修正申請が全て表示されていること
2. カラムの項目がUIと一致していること"
				FN049	申請詳細遷移機能	各項目の「詳細」を押下すると，申請詳細画面に遷移すること
		US015	管理者ユーザーは修正申請の詳細を確認 / 承認することができる	FN050	申請詳細取得機能	"1. 詳細画面の内容が，動線上で自分が選択した情報と一致していること
2. 詳細画面の内容が，正しく実際の打刻内容が反映されていること"
				FN051	承認機能	"「承認」を行うと以下の振る舞いをすること
1. 管理者ユーザーの「修正申請一覧」で，”承認待ち”から”承認済み”に変更されていること
2. 一般ユーザーの当該勤怠情報が更新され，修正申請の内容と一致すること
3. 一般ユーザーの「修正申請一覧」で，”承認待ち”から”承認済み”に変更されていること"

## 画面定義					
			画面ID	画面名称	パス	留意点	
			PG01	会員登録画面（一般ユーザー）	/register		
			PG02	ログイン画面（一般ユーザー）	/login		
			PG03	勤怠登録画面（一般ユーザー）	/attendance		
			PG04	勤怠一覧画面（一般ユーザー）	/attendance/list		任意の月の出勤退勤時刻、休憩時間、勤務合計時間の一覧が表示される
			PG05	勤怠詳細画面（一般ユーザー）	/attendance/detail/{id}	動的セグメントとして記載	名前、日付、出勤退勤時刻、休憩時刻、備考欄を修正できる
			PG06	申請一覧画面（一般ユーザー）	/stamp_correction_request/list		申請の承認状態、申請者本人の名前、対象日時、申請理由、申請日時が表示される
			PG07	ログイン画面（管理者）	/admin/login		
			PG08	勤怠一覧画面（管理者）	/admin/attendance/list		選択した日付のスタッフの出勤時間・退勤時間・休憩時間・合計勤務時間を表示
			PG09	勤怠詳細画面（管理者）	admin/attendance/{id}	動的セグメントとして記載	選択したスタッフと日付の、出勤退勤時間、休憩時間の詳細、備考が表示される
			PG10	スタッフ一覧画面（管理者）	/admin/staff/list		スタッフの名前、メールアドレスが表示される
			PG11	スタッフ別勤怠一覧画面（管理者）	/admin/attendance/staff/{id}	動的セグメントとして記載	任意の月とスタッフの出勤退勤、休憩、勤務合計時間が表示される
			PG12	申請一覧画面（管理者）	/stamp_correction_request/list	一般ユーザーと同じパスを使用。認証ミドルウェアで区別	 勤務申請状態、申請者の名前、申請理由、申請日時が表示される
			PG13	修正申請承認画面（管理者）	/stamp_correction_request/approve/{attendance_correct_request_id}	動的セグメントとして記載	